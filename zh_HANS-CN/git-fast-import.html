<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
<head>
<meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<meta name="generator" content="Asciidoctor 2.0.23"/>
<title>git-fast-import(1)</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"/>
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.square{list-style-type:square}
ul.circle ul:not([class]),ul.disc ul:not([class]),ul.square ul:not([class]){list-style:inherit}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child{border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:first-child,.sidebarblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child,.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active,#footnotes .footnote a:first-of-type:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,td.hdlist1,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
</head>
<body class="manpage">
<div id="header">
<h1>git-fast-import(1) Manual Page</h1>
<h2 id="_名称">名称</h2>
<div class="sectionbody">
<p>git-fast-import - 快速 Git 数据导入的后端</p>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_概述">概述</h2>
<div class="sectionbody">
<div class="verseblock">
<pre class="content">frontend | <em>git fast-import</em> [&lt;多个选项&gt;]</pre>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_描述">描述</h2>
<div class="sectionbody">
<div class="paragraph">
<p>最终用户通常并不想直接运行这个程序。 大多数最终用户都希望使用现有的前端程序，这些程序会解析特定类型的外来源，并将其中存储的内容输入到 <em>git fast-import</em> 中。</p>
</div>
<div class="paragraph">
<p>fast-import 从标准输入端读取混合命令/数据流，并将一个或多个文件包直接写入当前仓库。 当标准输入收到 EOF 时，fast import 会写出更新的分支和标记引用，用新导入的数据完全更新当前仓库。</p>
</div>
<div class="paragraph">
<p>快速导入后端本身可以导入一个空仓本库（一个已被 <em>git init</em> 初始化的仓库），也可以增量更新一个已填充的仓库。 是否支持从特定外来源增量导入，取决于所使用的前端程序。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_选项">选项</h2>
<div class="sectionbody">
<div class="dlist">
<dl>
<dt class="hdlist1">--force</dt>
<dd>
<p>强制更新已修改的现有分支，即使这样做会导致提交丢失（因为新提交不包含旧提交）。</p>
</dd>
<dt class="hdlist1">--quiet</dt>
<dd>
<p>禁用 --stats 显示的输出，使 fast-import 在成功导入时通常保持沉默。 不过，如果导入流中有用于显示用户输出的指令（如 <code>progress</code> 指令），则仍会显示相应的信息。</p>
</dd>
<dt class="hdlist1">--stats</dt>
<dd>
<p>显示 fast-import 创建的对象、这些对象存储在哪些文件包中，以及 fast-import 在运行过程中使用的内存等基本统计数据。 默认情况下显示此输出，但可使用 --quiet 关闭此功能。</p>
</dd>
<dt class="hdlist1">--allow-unsafe-features</dt>
<dd>
<p>通过使用 <code>feature</code> 或 <code>option</code> 命令，许多命令行选项可以作为 fast-import 流本身的一部分提供。然而，其中一些选项是不安全的（例如，允许 fast-import 访问仓库之外的文件系统）。这些选项默认是禁用的，但可以通过在命令行中提供该选项来允许。 目前这只影响 <code>export-marks</code>、<code>import-marks</code> 和 <code>import-marks-if-exists</code>。</p>
<div class="literalblock">
<div class="content">
<pre>只有在信任生成快速导入流的程序时，才能启用此选项！对于使用 `import` 功能的远程帮助程序，该选项会自动启用，因为它们已经被信任可以运行自己的代码。</pre>
</div>
</div>
</dd>
</dl>
</div>
<div class="sect2">
<h3 id="_前端的选项">前端的选项</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">--cat-blob-fd=&lt;fd&gt;</dt>
<dd>
<p>将对 <code>get-mark</code>、<code>cat-blob</code> 和 <code>ls</code> 查询的响应写入文件描述符 &lt;fd&gt; 而不是 <code>stdout</code>。 允许将面向最终用户的 <code>progress</code> 输出与其他输出分开。</p>
</dd>
<dt class="hdlist1">--date-format=&lt;格式&gt;</dt>
<dd>
<p>指定前台在 <code>author</code>, <code>committer</code> 和 <code>tagger</code> 命令中提供给快速导入的日期类型。 有关支持的格式及其语法的详细信息，请参阅下面的 "日期格式"。</p>
</dd>
<dt class="hdlist1">--done</dt>
<dd>
<p>如果数据流末尾没有 <code>done</code> 命令，则错误终止。 该选项可能有助于检测导致前端在开始写入数据流之前就终止的错误。</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_标记文件的位置">标记文件的位置</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">--export-marks=&lt;文件&gt;</dt>
<dd>
<p>完成后将内部标记表转存到 &lt;文件&gt; 中。 标记以 <code>:markid</code> <code>SHA-1</code> 的形式每行写一个。 前端可在导入完成后使用此文件验证导入，或在增量运行时保存标记表。 由于 &lt;文件&gt; 只在检查点（或完成时）打开和截断，因此同样的路径也可以安全地提供给 --import-marks 文件。</p>
</dd>
<dt class="hdlist1">--import-marks=&lt;文件&gt;</dt>
<dd>
<p>在处理任何输入之前，加载 &lt;文件&gt; 中指定的标记。 输入文件必须存在，必须可读，必须使用与 --export-marks 生成的相同格式。 可以提供多个选项来导入多组标记。 如果一个标记被定义为不同的值，则以最后一个文件为准。</p>
</dd>
<dt class="hdlist1">--import-marks-if-exists=&lt;文件&gt;</dt>
<dd>
<p>与 --import-marks 类似，但不会出错，而是在文件不存在时自动跳过。</p>
</dd>
<dt class="hdlist1">--[no-]relative-marks</dt>
<dd>
<p>指定 --relative-marks（相对标记）后，用 --import-marks= 和 --export-marks= 指定的路径将相对于当前仓库的内部目录。 在 git-fast-import 中，这意味着路径是相对于 .git/info/fast-import 目录的。不过，其他导入程序可能会使用不同的位置。</p>
<div class="paragraph">
<p>相对标记和非相对标记可以通过--(no-)-relative-marks 与--(import|export)-marks= 选项交织使用。</p>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_重写子模块">重写子模块</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">--rewrite-submodules-from=&lt;名称&gt;:&lt;文件&gt;</dt>
<dt class="hdlist1">--rewrite-submodules-to=&lt;名称&gt;:&lt;文件&gt;</dt>
<dd>
<p>将 &lt;名称&gt; 指定的子模块的对象 ID 从 from &lt;文件&gt; 中使用的值重写为 to &lt;文件&gt; 中使用的值。from 标记应由 <code>git</code> <code>fast-export</code> 创建，而 to 标记应在导入同一子模块时由 <code>git</code> <code>fast-import</code> 创建。</p>
<div class="paragraph">
<p>&lt;名称&gt; 可以是不含冒号的任意字符串，但在指定相应标记时，两个选项必须使用相同的值。 可以使用不同的 &lt;名称&gt; 值指定多个子模块。不在相应的选项对中使用这些选项是错误的。</p>
</div>
<div class="paragraph">
<p>这些选项主要用于将仓库从一种哈希算法转换为另一种哈希算法；如果没有这些选项，fast-import 在遇到子模块时就会失败，因为它无法将对象 ID 写入新的哈希算法。</p>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_性能和压缩调整">性能和压缩调整</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">--active-branches=&lt;n&gt;</dt>
<dd>
<p>同时激活的最大分支数。 详情请参阅下文的 "内存利用率"。 默认为 5。</p>
</dd>
<dt class="hdlist1">--big-file-threshold=&lt;n&gt;</dt>
<dd>
<p>fast-import 将尝试创建 delta 的 blob 的最大大小，以字节为单位。 默认值为 512m（512MB）。 有些导入者可能希望在内存有限的系统上降低该值。</p>
</dd>
<dt class="hdlist1">--depth=&lt;n&gt;</dt>
<dd>
<p>用于 blob 和树形脱模的最大脱模深度。 默认值为 50。</p>
</dd>
<dt class="hdlist1">--export-pack-edges=&lt;文件&gt;</dt>
<dd>
<p>创建 packfile 后，向 &lt;文件&gt; 打印一行数据，列出 packfile 的文件名和写入该 packfile 的每个分支的最后一次提交。 在导入总对象集超过 4 GiB packfile 限制的项目后，这些信息可能会很有用，因为在调用 <em>git pack-objects</em> 时，这些提交可以用作边缘点。</p>
</dd>
<dt class="hdlist1">--max-pack-size=&lt;n&gt;</dt>
<dd>
<p>每个输出包文件的最大大小。 默认为无限大。</p>
</dd>
<dt class="hdlist1">fastimport.unpackLimit</dt>
<dd>
<p>参见 <a href="git-config.html">git-config(1)</a></p>
</dd>
</dl>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_性能">性能</h2>
<div class="sectionbody">
<div class="paragraph">
<p>fast-import 的设计使其能够以最少的内存占用和处理时间导入大型项目。 假设前端能够跟上 fast-import 的速度，并向其提供源源不断的数据流，那么对于拥有 10 年以上历史、包含 100,000 多次单独提交的项目，通常只需 1-2 个小时就能完成导入，而且硬件配置也不高（约 2,000 美元）。</p>
</div>
<div class="paragraph">
<p>大多数瓶颈似乎都出现在国外源数据访问（源无法以足够快的速度提取修订）或磁盘 IO（快速导入写入的速度与磁盘接受数据的速度一样快）上。 如果源数据存储在与目标 Git 仓库不同的驱动器上，导入速度会更快（因为 IO 竞争更少）。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_开发成本">开发成本</h2>
<div class="sectionbody">
<div class="paragraph">
<p>一个典型的快速导入前端往往需要大约 200 行 Perl/Python/Ruby 代码。 大多数开发人员都能在几个小时内创建出可用的导入程序，尽管这是他们第一次接触快速导入，有时甚至是第一次接触 Git。 鉴于大多数转换工具都是一次性工具（用过一次就不再回头），这种情况是最理想的。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_并行操作">并行操作</h2>
<div class="sectionbody">
<div class="paragraph">
<p>与 <em>git push</em> 或 <em>git fetch</em> 一样，由 fast-import 处理的导入可以安全地与并行的 <code>git</code> <code>repack</code> <code>-a</code> <code>-d</code> 或 `git gc`调用，或任何其他 Git 操作（包括 <em>git prune</em>，因为 fast-import 从不使用松散对象）同时运行。</p>
</div>
<div class="paragraph">
<p>fast-import 不会锁定正在导入的分支或标签引用。 导入后，在引用更新阶段，fast-import 会测试每个现有分支引用，以验证更新是否为快进更新（存储在引用中的提交包含在要写入的提交的新历史中）。 如果更新不是快进更新，fast-import 会跳过更新该引用，并打印警告信息。fast-import 会一直尝试更新所有分支引用，不会因为第一次失败而停止。</p>
</div>
<div class="paragraph">
<p>分支更新可以使用 --force 强制进行，但建议只在没有更新的仓库中使用。 初次导入空仓库时，无需使用 --force。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_技术探讨">技术探讨</h2>
<div class="sectionbody">
<div class="paragraph">
<p>fast-import 会在内存中跟踪一组分支。 在导入过程中，任何分支都可以通过向输入流发送 <code>commit</code> 命令来创建或修改。 这种设计允许前端程序同时处理数量不限的分支，并按照源数据的顺序生成提交。 这也大大简化了前端程序。</p>
</div>
<div class="paragraph">
<p>fast-import 不会使用或更改当前工作目录或其中的任何文件。 (但它会更新当前的 Git 仓库，正如 <code>GIT_DIR</code> 所引用的那样）。 因此，导入前端可能会出于自己的目的使用工作目录，比如从外来源中提取文件修订版。 这种对工作目录的无视也使得 fast-import 可以非常快速地运行，因为在分支间切换时，它不需要执行任何代价高昂的文件更新操作。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_输入格式">输入格式</h2>
<div class="sectionbody">
<div class="paragraph">
<p>除了原始文件数据（Git 不会对其进行解释），快速导入输入格式都是基于文本（ASCII）的。 这种基于文本的格式简化了前端程序的开发和调试，尤其是在使用 Perl、Python 或 Ruby 等高级语言的情况下。</p>
</div>
<div class="paragraph">
<p>fast-import 对输入的要求非常严格。 我们在下文中所说的 SP 是指一个空格。 同样，LF 表示一个（且只有一个）换行符，HT 表示一个（且只有一个）水平制表符。 提供额外的空格字符会导致意想不到的结果，如分支名称或文件名称中包含前导空格或尾部空格，或当 fast-import 遇到意外输入时提前终止。</p>
</div>
<div class="sect2">
<h3 id="_流评论">流评论</h3>
<div class="paragraph">
<p>为了帮助调试前端，fast-import 会忽略任何以 #（ASCII 磅/散列）开头的行，包括以 <code>LF</code> 结尾的行。 注释行可以包含任何不包含 LF 的字节序列，因此可以用来包含任何详细的调试信息，这些信息可能是前端特有的，在检查 fast-import 数据流时也很有用。</p>
</div>
</div>
<div class="sect2">
<h3 id="_日期格式">日期格式</h3>
<div class="paragraph">
<p>支持以下日期格式。 前台应通过在 --date-format=&lt;日期格式&gt; 命令行选项中传递格式名称来选择导入时使用的格式。</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>raw</code></dt>
<dd>
<p>这是 Git 的本地格式，为 <em>&lt;time&gt;</em> <code>SP</code> <em>&lt;offutc&gt;</em>。 如果没有指定 --date-format 格式，它也是 fast-import 的默认格式。</p>
<div class="paragraph">
<p>事件发生的时间由 &lt;时间&gt; 指定，是自 UNIX 纪元（世界协调时 1970 年 1 月 1 日午夜）以来的秒数，并写成 ASCII 十进制整数。</p>
</div>
<div class="paragraph">
<p>本地偏移量由 <em>&lt;offutc&gt;</em> 指定，与 UTC 的偏移量为正或负。 例如，东部标准时间（比协调世界时晚 5 小时）在 <em>&lt;tz&gt;</em> 中表示为 <em>'0500</em>'，而协调世界时为 <em>'+0000</em>'。 本地偏移并不影响 <em>&lt;time&gt;</em>；它只是作为一种提示，帮助格式化例程显示时间戳。</p>
</div>
<div class="paragraph">
<p>如果源材料中没有本地偏移量，则使用 <em>'+0000</em>' 或最常用的本地偏移量。 例如，许多组织都有一个 CVS 仓库，只有位于同一地点和时区的用户才能访问该仓库。 在这种情况下，可以假定与 UTC 有合理的偏移。</p>
</div>
<div class="paragraph">
<p>与 <code>rfc2822</code> 格式不同，该格式非常严格。 格式上的任何变化都会导致 fast-import 拒绝该值，同时也会对数值进行一些正确性检查。</p>
</div>
</dd>
<dt class="hdlist1"><code>raw-permissive</code></dt>
<dd>
<p>这与 <code>raw</code> 相同，只是不对数字纪元和本地偏移进行正确性检查。 这在过滤或导入包含错误时区值等内容的现有历史记录时非常有用。</p>
</dd>
<dt class="hdlist1"><code>rfc2822</code></dt>
<dd>
<p>This is the standard date format as described by RFC 2822.</p>
<div class="paragraph">
<p>示例值为 <em>'Tue Feb 6 11:22:18 2007 -0500</em>'。 Git 解析器很准确，但有点偏宽松。 它与 <em>git am</em> 在应用从电子邮件收到的补丁时使用的解析器相同。</p>
</div>
<div class="paragraph">
<p>有些畸形字符串可能会被当作有效日期。 在某些情况下，Git 仍能从畸形字符串中获取正确的日期。 还有一些类型的畸形字符串，Git 会将其解析为错误，但认为是有效的。 严重的畸形字符串将被拒绝。</p>
</div>
<div class="paragraph">
<p>与上述 <code>raw</code> 格式不同，RFC 2822 日期字符串中包含的时区/UTC 偏移信息用于在存储前将日期值调整为 UTC。 因此，该信息必须尽可能准确。</p>
</div>
<div class="paragraph">
<p>如果源材料使用 RFC 2822 样式的日期，前台应让 fast-import 处理解析和转换（而不是自己尝试），因为 Git 解析器已在野外进行了良好的测试。</p>
</div>
<div class="paragraph">
<p>如果源材料已经使用了 UNIX-epoch 格式，或者可以哄骗源材料以该格式提供日期，或者源材料的格式很容易转换成该格式（因为在解析时不会产生歧义），那么前端程序应优先使用 <code>raw</code> 格式。</p>
</div>
</dd>
<dt class="hdlist1"><code>now</code></dt>
<dd>
<p>始终使用当前时间和时区。 必须始终为 <em>&lt;when&gt;</em> 提供字面意义上的 <code>now</code>。</p>
<div class="paragraph">
<p>这是一种玩具格式。 在通过快速导入创建身份字符串时，系统的当前时间和时区总是被复制到身份字符串中。 无法指定不同的时间或时区。</p>
</div>
<div class="paragraph">
<p>提供这种格式的原因是，它的实现时间很短，而且可能对想要立即创建新提交的进程很有用，而不需要使用工作目录或 <em>git update-index</em>。</p>
</div>
<div class="paragraph">
<p>如果在 <code>commit</code> 中分别使用了 <code>authoe</code> 和 <code>committer</code> 命令，时间戳可能会不一致，因为系统时钟会轮询两次（每条命令一次）。 确保作者和提交者身份信息具有相同时间戳的唯一方法是省略 <code>author</code> 命令（因此从 <code>committer</code> 命令复制），或使用除 <code>now</code> 以外的其他日期格式。</p>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_命令">命令</h3>
<div class="paragraph">
<p>fast-import 接受多条命令来更新当前仓库和控制当前导入过程。 稍后将对每条命令进行更详细的讨论（附示例）。</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>commit</code></dt>
<dd>
<p>通过创建新提交并更新分支以指向新创建的提交，创建新分支或更新现有分支。</p>
</dd>
<dt class="hdlist1"><code>tag</code></dt>
<dd>
<p>从现有提交或分支创建注释标签对象。 此命令不支持轻量级标记，因为不建议用它们来记录有意义的时间点。</p>
</dd>
<dt class="hdlist1"><code>reset</code></dt>
<dd>
<p>将现有分支（或新分支）重置为特定版本。 必须使用这条命令，才能在不提交的情况下，将分支更改为特定版本。</p>
</dd>
<dt class="hdlist1"><code>blob</code></dt>
<dd>
<p>将原始文件数据转换为 blob，以便将来在 <code>commit</code> 命令中使用。 该命令是可选的，执行导入时不需要。</p>
</dd>
<dt class="hdlist1"><code>alias</code></dt>
<dd>
<p>在不创建任何新对象的情况下，记录一个标记指向一个给定对象。 使用 --import-marks 并引用缺失的标记会导致 fast-import 失败，因此别名可以提供一种方法，将原本已剪枝的提交设置为有效值（例如最近的未剪枝祖先）。</p>
</dd>
<dt class="hdlist1"><code>checkpoint</code></dt>
<dd>
<p>强制 fast-import 关闭当前包文件，生成其唯一的 SHA-1 校验和和索引，并启动一个新的包文件。 此命令为可选命令，执行导入时无需使用。</p>
</dd>
<dt class="hdlist1"><code>progress</code></dt>
<dd>
<p>使 fast-import 将整行内容回传至自己的标准输出。 该命令是可选的，执行导入时不需要它。</p>
</dd>
<dt class="hdlist1"><code>done</code></dt>
<dd>
<p>标记数据流的结束。除非使用 <code>--done</code> 命令行选项或 <code>feature</code> <code>done</code> 命令要求使用 <code>done</code> 功能，否则该命令是可选的。</p>
</dd>
<dt class="hdlist1"><code>get-mark</code></dt>
<dd>
<p>使 fast-import 向使用 <code>--cat-blob-fd</code> 设置的文件描述符打印标记对应的 SHA-1 值，如果未指定，则打印 <code>stdout</code>。</p>
</dd>
<dt class="hdlist1"><code>cat-blob</code></dt>
<dd>
<p>使 fast-import 以 <em>cat-file --batch</em> 格式向使用 <code>--cat-blob-fd</code> 或 <code>stdout</code> 设置的文件描述符打印 blob。</p>
</dd>
<dt class="hdlist1"><code>ls</code></dt>
<dd>
<p>使 fast-import 以 <em>ls-tree</em> 格式向使用 <code>--cat-blob-fd</code> 或 <code>stdout</code> 设置的文件描述符打印描述目录条目的行。</p>
</dd>
<dt class="hdlist1"><code>feature</code></dt>
<dd>
<p>启用指定功能。这要求 fast-import 支持指定的功能，如果不支持则会终止。</p>
</dd>
<dt class="hdlist1"><code>option</code></dt>
<dd>
<p>指定 "选项"（OPTIONS）中列出的任何选项，这些选项不会改变流语义以适应前台的需要。此命令为可选项，执行导入时不需要。</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_commit"><code>commit</code></h3>
<div class="paragraph">
<p>用新的提交创建或更新分支，记录项目的逻辑变更。</p>
</div>
<div class="literalblock">
<div class="content">
<pre>        'commit' SP &lt;引用&gt; LF
        mark?
        original-oid?
        ('author' (SP &lt;名称&gt;)? SP LT &lt;email&gt; GT SP &lt;when&gt; LF)?
        'committer' (SP &lt;名称&gt;)? SP LT &lt;email&gt; GT SP &lt;when&gt; LF
        ('encoding' SP &lt;编码&gt;)?
        data
        ('from' SP &lt;提交号&gt; LF)?
        ('merge' SP &lt;提交号&gt; LF)*
        (filemodify | filedelete | filecopy | filerename | filedeleteall | notemodify)*
        LF?</pre>
</div>
</div>
<div class="paragraph">
<p>其中 &lt;引用&gt; 是要提交的分支名称。 在 Git 中，分支名称通常以 <code>refs/heads/</code> 为前缀，因此导入 CVS 分支符号 <code>RELENG-1_0</code> 时，&lt;引用&gt; 的值应为 <code>refs/heads/RELENG-1_0</code>。 在 Git 中，&lt;引用&gt; 的值必须是有效的引用名称。 由于 <code>LF</code> 在 Git 引用名称中无效，因此此处不支持引号或转义语法。</p>
</div>
<div class="paragraph">
<p><code>mark</code>（标记）命令可能会出现，要求 fast-import 保存新创建提交的引用，供前端将来使用（格式见下文）。 前端通常会标记他们创建的每个提交，从而允许将来从任何导入的提交中创建分支。</p>
</div>
<div class="paragraph">
<p>在 <code>committer</code> 之后的 <code>data</code> 命令必须提供提交信息（请参阅下面的 <code>data</code> 命令语法）。 要导入空的提交信息，请使用长度为 0 的数据。 提交信息是自由格式的，Git 无法解释。 目前它们必须以 UTF-8 编码，因为 fast-import 不允许指定其他编码。</p>
</div>
<div class="paragraph">
<p>在创建提交之前，可以包含零个或多个 <code>filemodify</code>, <code>filedelete</code>, <code>filecopy</code>, <code>filerename</code>, <code>filedeleteall</code> 和 <code>notemodify</code> 命令来更新分支的内容。 这些命令可以任意顺序提供。 不过，我们建议在同一提交中的所有 <code>filemodify</code>, <code>filecopy</code>, <code>filerename</code> 和 <code>notemodify</code> 命令之前都加上 <code>filedeleteall</code> 命令，因为 <code>filedeleteall</code> 会将分支清除干净（见下文）。</p>
</div>
<div class="paragraph">
<p>命令后的 <code>LF</code> 是可选的（以前是必须的）。 请注意，出于向后兼容性的考虑，如果提交以一条 <code>data</code> 命令结束（即没有 <code>from</code>、<code>mmerge</code>、<code>filemodify</code>、<code>filedelete</code>、<code>filecopy</code>、<code>filerename</code>、<code>filedeleteall</code> 或 <code>notemodify</code> 命令），那么命令末尾可能会出现两条 <code>LF</code> 命令，而不是只有一条。</p>
</div>
<div class="sect3">
<h4 id="_author"><code>author</code></h4>
<div class="paragraph">
<p>如果作者信息可能与提交者信息不同，可选择使用 <code>author</code> 命令。 如果省略了 <code>author</code> 命令，那么 fast-import 将自动使用提交者的信息来处理提交的作者部分。 有关 <code>author</code> 字段的描述，请参阅下文，因为它们与 <code>committer</code> 相同。</p>
</div>
</div>
<div class="sect3">
<h4 id="_committer"><code>committer</code></h4>
<div class="paragraph">
<p><code>committer</code> 命令会显示谁提交了该提交，以及提交的时间。</p>
</div>
<div class="paragraph">
<p>这里的`&lt;名称&gt;是个人的显示名（例如 ''Com <code>M</code> <code>Itter</code>''），&lt;email&gt;是个人的电子邮件地址（''\cm@example.<code>com</code>''）。 `LT 和 <code>GT</code> 是字面上的小于（\x3c）和大于（\x3e）符号。 需要使用这些符号将电子邮件地址与行中的其他字段分隔开来。 请注意，&lt;名称&gt; 和 <em>&lt;email&gt;</em>`是自由格式，可以包含任何字节序列，但 `LT、<code>GT</code> 和`LF` 除外。 &lt;名称&gt; 通常采用 UTF-8 编码。</p>
</div>
<div class="paragraph">
<p>更改的时间由 &#8216;&lt;when&gt;`指定，并使用 --date-format=&lt;日期格式&gt; 命令行选项选择的日期格式。 有关支持的格式及其语法，请参阅上文的 <em>'日期格式</em>&#8217;。</p>
</div>
</div>
<div class="sect3">
<h4 id="_encoding"><code>encoding</code></h4>
<div class="paragraph">
<p>可选的 <code>encoding</code> 命令表示提交信息的编码。 大多数提交信息都是 UTF-8 编码，编码可以省略，但这样就可以将提交信息导入 git 而无需先重新编码。</p>
</div>
</div>
<div class="sect3">
<h4 id="_from"><code>from</code></h4>
<div class="paragraph">
<p><code>from</code> 命令用于指定从哪个提交开始初始化分支。 此修订将成为新提交的第一个祖先。 在此提交中构建的树的状态将从 <code>from</code> 提交中的状态开始，并由此提交中的内容修改所改变。</p>
</div>
<div class="paragraph">
<p>在新分支的第一次提交中省略 <code>from</code> 命令会导致 fast-import 创建的提交没有祖先。这往往只适用于项目的首次提交。 如果前端在创建新分支时从头开始创建所有文件，则可以使用 <code>merge</code> 命令代替 <code>from</code> 命令，以空树开始提交。 在现有分支上，通常希望省略 <code>from</code> 命令，因为该分支上的当前提交会被自动假定为新提交的第一个祖先。</p>
</div>
<div class="paragraph">
<p>由于 <code>LF</code> 在 Git 引用名称或 SHA-1 表达式中无效，因此 &lt;提交号&gt; 中不支持引号或转义语法。</p>
</div>
<div class="paragraph">
<p>这里的 &lt;提交号&gt; 是指以下任何一种：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>fast-import 内部分支表中现有分支的名称。 如果 fast-import 不知道该名称，则将其视为 SHA-1 表达式。</p>
</li>
<li>
<p>标记引用，<em>&lt;idnum&gt;</em>，其中 `&lt;idnum&gt;`是标记编号。</p>
<div class="paragraph">
<p>fast-import 使用 <code>:</code> 表示标记引用的原因是，这个字符在 Git 分支名称中是不合法的。 前导的 <code>:</code> 便于区分标记 42 (<code>:42</code>)和分支 42 (<code>42</code> 或 <code>refs/heads/42</code>)，或缩写的 SHA-1，而后者恰好只由基数为 10 的数字组成。</p>
</div>
<div class="paragraph">
<p>标记必须先声明（通过 <code>mark</code> ）才能使用。</p>
</div>
</li>
<li>
<p>以十六进制表示的完整的 40 字节或缩写的 SHA-1 提交。</p>
</li>
<li>
<p>任何解析为提交的有效 Git SHA-1 表达式。 详见 <a href="gitrevisions.html">gitrevisions(7)</a> 中的 <em>'指定修订格式</em>'。</p>
</li>
<li>
<p>特殊的空 SHA-1（40 个零）表示要删除分支。</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>从当前分支值重新开始增量导入的特殊情况应写为：</p>
</div>
<div class="listingblock">
<div class="content">
<pre>        from refs/heads/branch^0</pre>
</div>
</div>
<div class="paragraph">
<p>后缀 <code>^0</code> 是必要的，因为 fast-import 不允许分支从自身开始，分支会在从输入的 <code>from</code> 命令读取之前在内存中创建。 添加 <code>^0</code> 会强制 fast-import 通过 Git 的修订解析库而非内部分支表来解析提交，从而加载分支的现有值。</p>
</div>
</div>
<div class="sect3">
<h4 id="_merge"><code>merge</code></h4>
<div class="paragraph">
<p>包括一个额外的祖先提交。 额外的祖先链接不会改变本次提交的树状态构建方式。 如果在创建新分支时省略了 <code>from</code> 命令，则第一个 <code>merge</code> 提交将是当前提交的第一个祖先，分支开始时将没有文件。 fast-import 允许在每次提交中使用不限次数的 <code>merge</code> 命令，从而建立 n 路合并。</p>
</div>
<div class="paragraph">
<p>这里的 &lt;提交号&gt; 是`from` 也接受的任何提交规范表达式（见上文）。</p>
</div>
</div>
<div class="sect3">
<h4 id="_filemodify"><code>filemodify</code></h4>
<div class="paragraph">
<p>包含在 <code>commit</code> 命令中，用于添加新文件或更改现有文件的内容。 该命令有两种指定文件内容的不同方式。</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">外部数据格式</dt>
<dd>
<p>文件的数据内容已由之前的 <code>blob</code> 命令提供。 前台只需将其连接起来即可。</p>
<div class="literalblock">
<div class="content">
<pre>        'M' SP &lt;模式&gt; SP &lt;引用日期&gt; SP &lt;路径&gt; LF</pre>
</div>
</div>
<div class="paragraph">
<p>通常情况下，&lt;数据引用&gt; 必须是由之前的 <code>blob</code> 命令设置的标记引用 (<code>:</code><em>&lt;idnum&gt;</em>)，或者是现有 Git blob 对象的完整 40 字节 SHA-1 值。 如果 &lt;模式&gt; 是 <code>040000</code>`，则 &lt;数据引用&gt; 必须是现有 Git 树对象的完整 40 字节 SHA-1 或用 <code>--import-marks</code> 设置的标记引用。</p>
</div>
</dd>
<dt class="hdlist1">内联数据格式</dt>
<dd>
<p>文件的数据内容尚未提供。 前台希望将其作为该修改命令的一部分提供。</p>
<div class="literalblock">
<div class="content">
<pre>        'M' SP &lt;模式&gt; SP 'inline' SP &lt;路径&gt; LF
        data</pre>
</div>
</div>
<div class="paragraph">
<p>有关 <code>data</code> 命令的详细说明，请参阅下文。</p>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>在这两种格式中，&lt;模式&gt; 都是以八进制指定的文件类型。 Git 仅支持以下模式：</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>100644</code> 或 <code>644</code>： 普通（不可执行）文件。 大多数项目中的大部分文件都使用这种模式。 如果不知道用什么格式，请使用这种模式。</p>
</li>
<li>
<p><code>100755</code> 或 <code>755</code>： 一个普通但可执行的文件。</p>
</li>
<li>
<p><code>120000</code> ：符号链接，文件内容将成为链接目标。</p>
</li>
<li>
<p><code>160000</code> ： 一个 Git 链接，对象的 SHA-1 指向另一个仓库中的提交。Git 链接只能通过 SHA 或提交标记指定。它们用于实现子模块。</p>
</li>
<li>
<p><code>040000</code> ：子目录。 子目录只能通过 SHA 或使用 <code>--import-marks</code> 设置的树形标记来指定。</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>在这两种格式中，&lt;路径&gt; 都是要添加（如果尚未存在）或修改（如果已经存在）的文件的完整路径。</p>
</div>
<div class="paragraph">
<p>&lt;路径&gt; 可以写成不带引号的字节串或 C 风格的引号字符串。</p>
</div>
<div class="paragraph">
<p>当 &lt;路径&gt; 不以双引号 (") 开头时，它是一个不带引号的字符串，并且被解析为不带任何转义序列的原始字节。然而，如果文件名包含 <code>LF</code> 或以双引号开头，它不能表示为不带引号的字符串，必须使用引号。此外，如果 <code>filecopy</code> 或 <code>filerename</code> 中的源 &lt;路径&gt; 包含空格（SP），则必须使用引号。</p>
</div>
<div class="paragraph">
<p>当 &lt;路径&gt; 以双引号 (") 开头时，它是一个 C 风格的引号字符串，其中完整的文件名被一对双引号包围，并且使用转义序列。某些字符必须通过在它们前面加上反斜杠来转义：<code>LF</code> 写作 \n，反斜杠写作 \\，双引号写作 \"。某些字符可以选择性地使用转义序列来书写：\a 表示响铃，\b 表示退格，\f 表示换页，\n 表示换行，\r 表示回车，\t 表示水平制表符，\v 表示垂直制表符。任何字节都可以使用 3 位八进制代码来书写（例如，\033）。所有文件名都可以表示为引号字符串。</p>
</div>
<div class="paragraph">
<p>A <em>&lt;path&gt;</em> must use UNIX-style directory separators (forward slash <code>/</code>) and its value must be in canonical form. That is it must not:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>包含一个空目录组件（如 <code>foo//bar</code> 就是无效的），</p>
</li>
<li>
<p>以目录分隔符结尾（如 <code>foo/</code> 是无效的），</p>
</li>
<li>
<p>以目录分隔符开头（如 <code>/foo</code> 是无效的），</p>
</li>
<li>
<p>包含特殊成分 . 或 ..（例如，<code>foo/./bar</code> 和 <code>foo/</code><code>..</code><code>/bar</code> 是无效的）。</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>树根可以用空字符 &lt;路径&gt; 表示。</p>
</div>
<div class="paragraph">
<p><em>&lt;path&gt;</em> cannot contain NUL, either literally or escaped as \000. It is recommended that <em>&lt;path&gt;</em> always be encoded using UTF-8.</p>
</div>
</div>
<div class="sect3">
<h4 id="_filedelete"><code>filedelete</code></h4>
<div class="paragraph">
<p>包含在 <code>commit</code> 命令中，用于从分支中删除文件或递归删除整个目录。 如果文件或目录删除后其父级目录为空，父级目录也会自动删除。 这将沿着树向上逐级进行，直到到达第一个非空目录或根目录为止。</p>
</div>
<div class="literalblock">
<div class="content">
<pre>        'D' SP &lt;路径&gt; LF</pre>
</div>
</div>
<div class="paragraph">
<p>这里的 &lt;路劲&gt; 是要从分支中删除的文件或子目录的完整路径。 有关 &lt;路径&gt; 的详细说明，请参阅上文的 <code>filemodify</code> 。</p>
</div>
</div>
<div class="sect3">
<h4 id="_filecopy"><code>filecopy</code></h4>
<div class="paragraph">
<p>递归复制现有文件或子目录到分支内的不同位置。 现有文件或目录必须存在。 如果目标位置存在，它将被从源位置复制的内容完全取代。</p>
</div>
<div class="literalblock">
<div class="content">
<pre>        'C' SP &lt;路径&gt; SP &lt;路径&gt; LF</pre>
</div>
</div>
<div class="paragraph">
<p>这里第一个 &lt;路径&gt; 是源位置，第二个 &lt;路径&gt; 是目标位置。 关于 &lt;路径&gt; 的详细说明，请参阅上文的 <code>filemodify</code> 。 要使用包含 SP 的源路径，路径必须加引号。</p>
</div>
<div class="paragraph">
<p><code>filecopy</code>（文件复制）命令会立即生效。 一旦源位置被复制到目标位置，今后应用于源位置的任何命令都不会影响复制的目标位置。</p>
</div>
</div>
<div class="sect3">
<h4 id="_filerename"><code>filerename</code></h4>
<div class="paragraph">
<p>将现有文件或子目录重命名到分支内的不同位置。 现有文件或目录必须存在。如果目标目录存在，它将被源目录取代。</p>
</div>
<div class="literalblock">
<div class="content">
<pre>        'R' SP &lt;路径&gt; SP &lt;路径&gt; LF</pre>
</div>
</div>
<div class="paragraph">
<p>这里第一个 &lt;路径&gt; 是源位置，第二个 &lt;路径&gt; 是目标位置。 关于 &lt;路径&gt; 的详细说明，请参阅上文的 <code>filemodify</code> 。 要使用包含 SP 的源路径，路径必须加引号。</p>
</div>
<div class="paragraph">
<p><code>filename</code>（文件重命名）命令会立即生效。 一旦源位置被重命名为目标位置，今后应用于源位置的任何命令都将在该位置创建新文件，而不会影响重命名的目标位置。</p>
</div>
<div class="paragraph">
<p>请注意，<code>filerename</code> 等同于源位置的 <code>filecopy</code> 和 <code>filedelete</code>。 使用 <code>filerename</code> 在性能上略有优势，但优势非常小，不值得为了快速导入而尝试将源材料中的删除/添加对转换为重命名。 提供这个 <code>fileerename</code> 命令只是为了简化已经有重命名信息的前端程序，而不需要将其分解为 <code>filecopy</code> 和 <code>filedelete</code> 命令。</p>
</div>
</div>
<div class="sect3">
<h4 id="_filedeleteall"><code>filedeleteall</code></h4>
<div class="paragraph">
<p>包含在 <code>commit</code> 命令中，用于删除分支中的所有文件（以及所有目录）。 该命令会重置内部分支结构，使其不包含任何文件，从而允许前台随后从头开始添加所有感兴趣的文件。</p>
</div>
<div class="literalblock">
<div class="content">
<pre>        'deleteall' LF</pre>
</div>
</div>
<div class="paragraph">
<p>如果前台不知道（或不关心知道）当前分支上有哪些文件，因而无法生成适当的 <code>filedelete</code> 命令来更新内容，那么这条命令就非常有用。</p>
</div>
<div class="paragraph">
<p>在发出 <code>filedeleteall</code> 命令后，再发出所需的 <code>filemodify</code> 命令来设置正确的内容，与只发出所需的 <code>filemodify</code> 和 <code>filedelete</code> 命令产生的结果是一样的。 不过，<code>filedeleteall</code> 方法可能会要求 fast-import 在每个活动分支上使用稍多的内存（对于大多数大型项目而言，内存都小于 1MB）；因此，我们鼓励能够轻松获取提交中仅受影响路径的前端这样做。</p>
</div>
</div>
<div class="sect3">
<h4 id="_notemodify"><code>notemodify</code></h4>
<div class="paragraph">
<p>包含在`commit` &lt;引用笔记&gt;`命令中，用于为 `&lt;提交号&gt; 添加新注释或更改注释内容。 在内部，它类似于在 &lt;提交号&gt; 路径（可能分成子目录）上的文件修改 100644。除了使用 <code>filedeleteall</code> 命令删除`&lt;notes_ref&gt;` 树中的所有现有注释外，不建议使用任何其他命令向 &lt;引用笔记&gt; 树中写入注释。 该命令有两种指定笔记内容的不同方法。</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">外部数据格式</dt>
<dd>
<p>注释的数据内容已由先前的 <code>blob</code> 命令提供。 前台只需将其连接到要注释的提交。</p>
<div class="literalblock">
<div class="content">
<pre>        'N' SP &lt;引用日期&gt; SP &lt;提交号&gt; LF</pre>
</div>
</div>
<div class="paragraph">
<p>这里的 &lt;数据引用&gt; 既可以是之前的 <code>blob</code> 命令设置的标记引用（<code>:</code><em>&lt;idnum&gt;</em>），也可以是现有 Git blob 对象的完整 40 字节 SHA-1 值。</p>
</div>
</dd>
<dt class="hdlist1">内联数据格式</dt>
<dd>
<p>备注的数据内容尚未提供。 前台希望将其作为该修改命令的一部分提供。</p>
<div class="literalblock">
<div class="content">
<pre>        'N' SP 'inline' SP &lt;提交号&gt; LF
        data</pre>
</div>
</div>
<div class="paragraph">
<p>有关 <code>data</code> 命令的详细说明，请参阅下文。</p>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>在这两种格式中，&lt;提交号&gt; 是 <code>from</code> 也接受的任何提交规范表达式（见上文）。</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_mark"><code>mark</code></h3>
<div class="paragraph">
<p>安排快速导入保存当前对象的引用，以便前端在未来某个时间点调用该对象，而无需知道其 SHA-1。 在这里，当前对象指的是 <code>mark</code> 命令中出现的对象创建命令。 这可以是 <code>commit</code>、<code>tag</code> 和 <code>blob</code>，但 <code>commit</code> 是最常见的用法。</p>
</div>
<div class="literalblock">
<div class="content">
<pre>        'mark' SP ':' &lt;idnum&gt; LF</pre>
</div>
</div>
<div class="paragraph">
<p>其中，<em>&lt;idnum&gt;</em> 是前台分配给此标记的编号。 <em>&lt;idnum&gt;</em> 的值用 ASCII 十进制整数表示。 0 是保留值，不能用作标记。 只有大于或等于 1 的值才能用作标记。</p>
</div>
<div class="paragraph">
<p>新标记会自动创建。 只需在另一个 <code>mark</code> 命令中重复使用相同的 <em>&lt;idnum&gt;</em>，即可将现有标记移动到另一个对象上。</p>
</div>
</div>
<div class="sect2">
<h3 id="_original_oid"><code>original-oid</code></h3>
<div class="paragraph">
<p>提供原始源码控制系统中对象的名称。fast-import 将直接忽略此指令，但在向 fast-import 输入数据流之前对其进行操作和修改的过滤进程可能会使用此信息</p>
</div>
<div class="literalblock">
<div class="content">
<pre>        'original-oid' SP &lt;对象标识符&gt; LF</pre>
</div>
</div>
<div class="paragraph">
<p>其中，&lt;对象标识符&gt; 是任何不包含 LF 的字符串。</p>
</div>
</div>
<div class="sect2">
<h3 id="_tag"><code>tag</code></h3>
<div class="paragraph">
<p>创建指向特定提交的注释标记。 要创建轻量级（无注释）标签，请参阅下面的 <code>reset</code> 命令。</p>
</div>
<div class="literalblock">
<div class="content">
<pre>        'tag' SP &lt;名称&gt; LF
        mark?
        'from' SP &lt;提交号&gt; LF
        original-oid?
        'tagger' (SP &lt;名称&gt;)? SP LT &lt;email&gt; GT SP &lt;when&gt; LF
        data</pre>
</div>
</div>
<div class="paragraph">
<p>其中 &lt;名称&gt; 是要创建的标记的名称。</p>
</div>
<div class="paragraph">
<p>因此，导入 CVS 分支符号 <code>RELENG-1_0-FINAL</code> 时，只需在 &lt;名称&gt; 中使用 <code>RELENG-1_0-FINAL</code>，而 fast-import 会将相应的引用写成 <code>refs/tags/RELENG-1_0-FINAL</code>。</p>
</div>
<div class="paragraph">
<p>在 Git 中，&lt;名称&gt; 的值必须是有效的引用名称，因此可能包含正斜杠。 由于 <code>LF</code> 在 Git 引用名称中无效，因此此处不支持引号或转义语法。</p>
</div>
<div class="paragraph">
<p><code>from</code> 命令与 <code>commit</code> 命令相同，详见上文。</p>
</div>
<div class="paragraph">
<p><code>tagger</code> 命令使用的格式与 <code>commit</code> 中的 <code>committer</code> 相同；详情参见上文。</p>
</div>
<div class="paragraph">
<p>在 <code>tagger</code> 之后的 <code>data</code> 命令必须提供已注释的标记信息（请参阅下面的 <code>data</code> 命令语法）。 要导入空标签信息，请使用长度为 0 的数据。 标签信息是自由格式的，不会被 Git 解释。 目前，它们必须以 UTF-8 编码，因为 fast-import 不允许指定其他编码。</p>
</div>
<div class="paragraph">
<p>不支持在 fast-import 中导入时对已注释的标记进行签名。 不建议尝试加入自己的 PGP/GPG 签名，因为前端无法（轻易）获取通常用于签名的完整字节集。 如果需要签名，请使用 <code>reset</code> 在 fast-import 中创建轻量级标签，然后使用标准的 <em>git tag</em> 流程离线创建这些标签的注释版本。</p>
</div>
</div>
<div class="sect2">
<h3 id="_reset"><code>reset</code></h3>
<div class="paragraph">
<p>创建（或重新创建）指定的分支，可选择从特定版本开始。 重置命令允许前台为现有分支发布新的 <code>from</code> 命令，或从现有提交创建新分支，而无需创建新提交。</p>
</div>
<div class="literalblock">
<div class="content">
<pre>        'reset' SP &lt;引用&gt; LF
        ('from' SP &lt;提交号&gt; LF)?
        LF?</pre>
</div>
</div>
<div class="paragraph">
<p>有关 &lt;引用&gt; 和 &lt;提交号&gt; 的详细说明，请参阅上文 <code>commit</code> 和 <code>from</code> 部分。</p>
</div>
<div class="paragraph">
<p>命令后的 <code>LF</code> 是可选项（以前是必选项）。</p>
</div>
<div class="paragraph">
<p><code>reset</code> （重置）命令还可用于创建轻量级（无注释）标记。 例如：</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="literalblock">
<div class="content">
<pre>reset refs/tags/938
from :938</pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>将创建轻量级标记 <code>refs/tags/938</code>，并引用提交标记 <code>:938</code>。</p>
</div>
</div>
<div class="sect2">
<h3 id="_blob"><code>blob</code></h3>
<div class="paragraph">
<p>请求向包文件写入一个文件修订。 修订版与任何提交都没有关联；这种关联必须在随后的 <code>commit</code> 命令中通过指定标记引用 blob 来形成。</p>
</div>
<div class="literalblock">
<div class="content">
<pre>        'blob' LF
        mark?
        original-oid?
        data</pre>
</div>
</div>
<div class="paragraph">
<p>这里的标记命令是可选的，因为有些前端选择自己为 blob 生成 Git SHA-1，并直接将其输入到 <code>commit</code> 中。 这通常是得不偿失的，因为标记的存储成本很低，而且易于使用。</p>
</div>
</div>
<div class="sect2">
<h3 id="_data"><code>data</code></h3>
<div class="paragraph">
<p>向 fast-import 提供原始数据（用作 blob/文件内容、提交信息或注释标签信息）。 提供的数据可以使用精确的字节数，也可以用终止行分隔。 用于生产质量转换的真正前端应始终使用精确字节数格式，因为这种格式更稳健、性能更好。 分隔格式主要用于测试快速导入。</p>
</div>
<div class="paragraph">
<p>在 <code>data</code> 命令的 <em>&lt;raw&gt;</em> 部分中出现的注释行总是被视为数据正文的一部分，因此 fast-import 不会忽略这些注释行。 这样就可以安全导入任何可能以 # 开头的文件/信息内容。</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">精确字节计数格式</dt>
<dd>
<p>前台必须指定数据的字节数。</p>
<div class="literalblock">
<div class="content">
<pre>        'data' SP &lt;count&gt; LF
        &lt;raw&gt; LF?</pre>
</div>
</div>
<div class="paragraph">
<p>其中，<em>&lt;count&gt;</em> 是出现在 <em>&lt;raw&gt;</em> 中的确切字节数。 <em>&lt;count&gt;</em> 的值用 ASCII 十进制整数表示。 <em>&lt;raw&gt;</em> 两侧的 <code>LF</code> 不包含在 <em>&lt;count&gt;</em> 中，也不会包含在导入的数据中。</p>
</div>
<div class="paragraph">
<p>在 <em>&lt;raw&gt;</em> 后面的 <code>LF</code> 是可选的（以前是必须的），但建议使用。 始终包含它可以使调试快速导入流变得更容易，因为下一条命令总是从下一行的第 0 列开始，即使 <em>&lt;raw&gt;</em> 没有以 <code>LF</code> 结束。</p>
</div>
</dd>
<dt class="hdlist1">分隔格式</dt>
<dd>
<p>fast-import 将通过搜索分隔符来计算长度。 这种格式主要用于测试，不建议用于真实数据。</p>
<div class="literalblock">
<div class="content">
<pre>        'data' SP '&lt;&lt;' &lt;分隔符&gt; LF
        &lt;原始格式&gt; LF
        &lt;分隔符&gt; LF
        LF?</pre>
</div>
</div>
<div class="paragraph">
<p>其中 <em>&lt;delim&gt;</em> 是选定的分隔符字符串。 字符串 <em>&lt;delim&gt;</em> 不能单独出现在 <em>&lt;raw&gt;</em> 中的一行，否则 fast-import 会认为数据结束的时间比实际时间早。 紧跟在 <em>&lt;raw&gt;</em> 后面的 <code>LF</code> 是 <em>&lt;raw&gt;</em> 的一部分。 这是分隔格式的限制之一，不可能提供最后一个字节没有 LF 的数据块。</p>
</div>
<div class="paragraph">
<p>在 <em>&lt;delim&gt;</em> <code>LF</code> 后面的 <code>LF</code> 是可选的（以前是必须的）。</p>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_alias"><code>alias</code></h3>
<div class="paragraph">
<p>记录标记指向某个对象，而无需先创建任何新对象。</p>
</div>
<div class="literalblock">
<div class="content">
<pre>        'alias' LF
        mark
        'to' SP &lt;提交号&gt; LF
        LF?</pre>
</div>
</div>
<div class="paragraph">
<p>有关 &lt;提交号&gt; 的详细说明，请参阅上文 <code>from</code> 部分。</p>
</div>
</div>
<div class="sect2">
<h3 id="_checkpoint"><code>checkpoint</code></h3>
<div class="paragraph">
<p>强制 fast-import 关闭当前的打包文件，启动一个新文件，并保存所有当前的分支参考、标记和标记。</p>
</div>
<div class="literalblock">
<div class="content">
<pre>        'checkpoint' LF
        LF?</pre>
</div>
</div>
<div class="paragraph">
<p>请注意，当当前包文件达到 --max-pack-size 或 4 GiB（以较小者为准）时，fast-import 会自动切换包文件。 在自动切换打包文件期间，fast-import 不会更新分支引用、标记或标记。</p>
</div>
<div class="paragraph">
<p>由于一个 <code>checkpoint</code> （检查点）可能需要大量的 CPU 时间和磁盘 IO（计算整个包的 SHA-1 校验和、生成相应的索引文件并更新引用），因此一条 <code>checkpoint</code> 命令可能需要几分钟才能完成。</p>
</div>
<div class="paragraph">
<p>前端可能会选择在超大、超长的导入过程中，或需要允许另一个 Git 进程访问某个分支时，发出检查点。 不过，通过 fast-import 将一个 30GB 的 Subversion 仓库加载到 Git 大约只需要 3 个小时，因此可能不需要明确的检查点。</p>
</div>
<div class="paragraph">
<p>命令后的 <code>LF</code> 是可选项（以前是必选项）。</p>
</div>
</div>
<div class="sect2">
<h3 id="_progress"><code>progress</code></h3>
<div class="paragraph">
<p>在处理输入流中的命令时，使 fast-import 将整个 <code>progress</code> 行未经修改地打印到标准输出通道（文件描述符 1）。 除此之外，该命令不会对当前导入或 fast-import 的任何内部状态产生影响。</p>
</div>
<div class="literalblock">
<div class="content">
<pre>        'progress' SP &lt;任意&gt; LF
        LF?</pre>
</div>
</div>
<div class="paragraph">
<p>命令的 &lt;任意&gt; 部分可包含不含 <code>LF</code> 的任何字节序列。 命令后的 <code>LF</code> 是可选的。 调用者可能希望通过 sed 等工具处理输出，例如删除行的前导部分：</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="literalblock">
<div class="content">
<pre>frontend | git fast-import | sed 's/^progress //'</pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>在 <code>checkpoint</code> 之后紧接一个 <code>progress</code> 命令，可以通知阅读器 <code>checkpoint</code> 何时完成，阅读器可以安全地访问快速导入更新的引用。</p>
</div>
</div>
<div class="sect2">
<h3 id="_get_mark"><code>get-mark</code></h3>
<div class="paragraph">
<p>命令 fast-import 将标记对应的 SHA-1 打印到标准输出流或之前用 <code>--cat-blob-fd</code> 参数安排的文件描述符。该命令不会对当前导入产生任何影响；其目的是检索 SHA-1，供以后的提交在提交信息中参考。</p>
</div>
<div class="literalblock">
<div class="content">
<pre>        'get-mark' SP ':' &lt;idnum&gt; LF</pre>
</div>
</div>
<div class="paragraph">
<p>有关如何安全读取输出结果的详细信息，请参阅下文 <em>'对命令的回复</em>'。</p>
</div>
</div>
<div class="sect2">
<h3 id="_cat_blob"><code>cat-blob</code></h3>
<div class="paragraph">
<p>使 fast-import 将 blob 打印到先前用 <code>--cat-blob-fd</code> 参数安排的文件描述符。 该命令不会对当前导入产生任何影响；其主要目的是检索 fast-import 内存中的 blob，但目标存储库无法访问这些 blob。</p>
</div>
<div class="literalblock">
<div class="content">
<pre>        'cat-blob' SP &lt;引用日期&gt; LF</pre>
</div>
</div>
<div class="paragraph">
<p>&lt;数据引用&gt; 可以是之前设置的标记引用 (<code>:</code><em>&lt;idnum&gt;</em>)，也可以是 Git blob 的完整 40 字节 SHA-1，可以是预先存在的，也可以是准备写入的。</p>
</div>
<div class="paragraph">
<p>输出格式与 <code>git</code> <code>cat-file</code> <code>--batch</code> 相同：</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="literalblock">
<div class="content">
<pre>&lt;sha1&gt; SP 'blob' SP &lt;尺寸&gt; LF
&lt;内容&gt; LF</pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>该命令可用于出现 <code>filemodify</code> 指令的地方，允许在提交中间使用。 对于使用内联指令的 <code>filemodify</code>，它也可以出现在 <code>data</code> 指令之前。</p>
</div>
<div class="paragraph">
<p>有关如何安全读取输出结果的详细信息，请参阅下文 <em>'对命令的回复</em>'。</p>
</div>
</div>
<div class="sect2">
<h3 id="_ls"><code>ls</code></h3>
<div class="paragraph">
<p>打印文件描述符路径上的对象信息，该文件描述符是之前用 <code>--cat-blob-fd</code> 参数安排的。 这样就可以打印当前提交中的 blob（使用 <code>cat-blob</code> 时），或复制先前提交中的 blob 或树以用于当前提交（使用 <code>filemodify</code> 时）。</p>
</div>
<div class="paragraph">
<p><code>ls</code> 命令也可用于出现 <code>filemodify</code> 指令的地方，允许在提交过程中使用。</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">从活动提交中读取</dt>
<dd>
<p>这种形式只能在 <code>commit</code> 过程中使用。 路径命名 fast-import 活动提交中的目录条目。 在这种情况下，路径必须加引号。</p>
<div class="literalblock">
<div class="content">
<pre>        'ls' SP &lt;路径&gt; LF</pre>
</div>
</div>
</dd>
<dt class="hdlist1">从命名树读取数据</dt>
<dd>
<p>&lt;数据引用&gt; 可以是一个标记引用 ( <code>:</code><em>&lt;idnum&gt;</em> )，也可以是 Git 标签、提交或树对象的完整 40 字节 SHA-1，可以是已存在的，也可以是等待写入的。 路径是相对于由 &lt;数据引用&gt; 命名的树的顶层的。</p>
<div class="literalblock">
<div class="content">
<pre>        'ls' SP &lt;引用日期&gt; SP &lt;路径&gt; LF</pre>
</div>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>有关 &lt;路径&gt; 的详细说明，请参阅上文的 <code>filemodify</code> 。</p>
</div>
<div class="paragraph">
<p>输出格式与 `git ls-tree &lt;目录树&gt;&#8201;&#8212;&#8201;&lt;路径&gt;`相同：</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="literalblock">
<div class="content">
<pre>&lt;模式&gt; SP ('blob' | 'tree' | 'commit') SP &lt;引用日期&gt; HT &lt;路径&gt; LF</pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>&lt;数据引用&gt; 表示 &lt;路劲&gt; 中的 blob、树或提交对象，可用于后面的 <em>get-mark</em>、<em>cat-blob</em>、<em>filemodify</em> 或 <em>ls</em> 命令。</p>
</div>
<div class="paragraph">
<p>如果该路径下没有文件或子树，<em>git fast-import</em> 将报告</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="literalblock">
<div class="content">
<pre>missing SP &lt;路径&gt; LF</pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>有关如何安全读取输出结果的详细信息，请参阅下文 <em>'对命令的回复</em>'。</p>
</div>
</div>
<div class="sect2">
<h3 id="_feature"><code>feature</code></h3>
<div class="paragraph">
<p>要求 fast-import 支持指定的功能，如果不支持则终止。</p>
</div>
<div class="literalblock">
<div class="content">
<pre>        'feature' SP &lt;功能&gt; ('=' &lt;参数&gt;)? LF</pre>
</div>
</div>
<div class="paragraph">
<p>命令的 &lt;功能&gt; 部分可以是以下任何一种：</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">date-format（日期格式）</dt>
<dt class="hdlist1">export-marks（出口标记）</dt>
<dt class="hdlist1">relative-marks</dt>
<dt class="hdlist1">no-relative-marks</dt>
<dt class="hdlist1">强制</dt>
<dd>
<p>就像在命令行中传递了带前导 <code>--</code> 的相应命令行选项一样（见上文选项）。</p>
</dd>
<dt class="hdlist1">import-marks（入口标记）</dt>
<dt class="hdlist1">import-marks-if-exists（导入标记是否存在）</dt>
<dd>
<p>与 --import-marks 类似，但有两点不同：第一，每个数据流只允许一条 "feature import-marks" 或 "feature import-marks-if-exists" 命令；第二，命令行选项 --import-marks= 或 --import-marks-if-exists 会覆盖数据流中的任何这些 "feature" 命令；第三，"feature import-marks-if-exists" 与相应的命令行选项一样，会静默地跳过一个不存在的文件。</p>
</dd>
<dt class="hdlist1">get-mark</dt>
<dt class="hdlist1">cat-blob</dt>
<dt class="hdlist1">ls</dt>
<dd>
<p>要求后端分别支持 <em>get-mark</em>、<em>cat-blob</em> 或 <em>ls</em> 命令。 不支持指定命令的 fast-import 版本在退出时会给出提示信息。 这样，导入过程中就不会在检测到不支持的命令之前浪费时间，而会在早期就出现明确的错误信息。</p>
</dd>
<dt class="hdlist1">备注</dt>
<dd>
<p>要求后端支持 <em>commit</em> 命令的 <em>notemodify</em>（N）子命令。 不支持备注的 fast-import 版本在退出时会显示相关信息。</p>
</dd>
<dt class="hdlist1">完成</dt>
<dd>
<p>如果数据流在没有 <em>done</em> （完成）命令的情况下结束，就会出错。 如果没有这项功能，导致前端在流中某个适当位置突然结束的错误就可能不会被发现。 例如，如果一个导入前端在操作中途死亡，而没有在其下属的 git fast-import 实例中发出 SIGTERM 或 SIGKILL，就可能发生这种情况。</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_option"><code>option</code></h3>
<div class="paragraph">
<p>处理指定的选项，使 git fast-import 的行为符合前端的需要。 注意，前端指定的选项会被用户为 git fast-import 本身指定的任何选项所覆盖。</p>
</div>
<div class="literalblock">
<div class="content">
<pre>    'option' SP &lt;选项&gt; LF</pre>
</div>
</div>
<div class="paragraph">
<p>&lt;选项&gt; 命令的一部分可能包含选项部分中列出的不更改导入语义的任何选项，而不更改前导 <code>--</code>，并且处理方式相同。</p>
</div>
<div class="paragraph">
<p>选项命令必须是输入的第一条命令（不包括功能命令），在任何非选项命令之后给出选项命令都是错误的。</p>
</div>
<div class="paragraph">
<p>以下命令行选项会改变导入语义，因此不能作为选项传递：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>date-format（日期格式）</p>
</li>
<li>
<p>import-marks（入口标记）</p>
</li>
<li>
<p>export-marks（出口标记）</p>
</li>
<li>
<p>cat-blob-fd</p>
</li>
<li>
<p>强制</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_done"><code>done</code></h3>
<div class="paragraph">
<p>如果未使用 <code>done</code> 功能，则视作已读取 EOF。 这可以用来告诉 fast-import 提前结束。</p>
</div>
<div class="paragraph">
<p>如果使用了 <code>--done</code> 命令行选项或 <code>feature</code> <code>done</code> 命令，则 <code>done</code> 命令是强制性的，标志着数据流的结束。</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_对命令的响应">对命令的响应</h2>
<div class="sectionbody">
<div class="paragraph">
<p>快速导入写入的新对象不能立即使用。 大多数 fast-import 命令在下一个检查点（或完成）之前都不会有明显的效果。 前端可以发送命令来填充 fast-import 的输入管道，而不必担心这些命令的生效速度，这样可以简化调度，从而提高性能。</p>
</div>
<div class="paragraph">
<p>不过，对于某些前端来说，在更新时从当前资源库读回数据是非常有用的（例如，当源材料以补丁的形式描述要应用到先前导入对象的对象时）。 这可以通过双向管道连接前端和快速导入来实现：</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="literalblock">
<div class="content">
<pre>mkfifo fast-import-output
frontend &lt;fast-import-output |
git fast-import &gt;fast-import-output</pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>以这种方式设置的前端可以使用 <code>progress</code>、<code>get-mark</code>、<code>ls</code> 和 <code>cat-blob</code> 命令从正在进行的导入中读取信息。</p>
</div>
<div class="paragraph">
<p>为避免死锁，此类前端在向 fast-import 写入可能阻塞的内容之前，必须完全耗尽来自 <code>progress</code>、<code>ls</code>、<code>get-mark</code> 和 <code>cat-blob</code> 的任何待处理输出。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_事故报告">事故报告</h2>
<div class="sectionbody">
<div class="paragraph">
<p>如果 fast-import 收到无效输入，它将以非零的退出状态终止，并在导入的 Git 仓库顶层创建一份崩溃报告。 崩溃报告包含 fast-import 内部状态的快照，以及导致崩溃的最新命令。</p>
</div>
<div class="paragraph">
<p>所有最近的命令（包括流注释、文件更改和进度命令）都会显示在崩溃报告中的命令历史记录中，但原始文件数据和提交信息不会显示在崩溃报告中。 这种排除可以节省报告文件的空间，并减少 fast-import 在执行过程中必须执行的缓冲量。</p>
</div>
<div class="paragraph">
<p>写完崩溃报告后，fast-import 会关闭当前的包文件并导出标记表。 这样，前端开发人员就可以检查仓库状态，并从崩溃的位置继续导入。 由于导入未成功完成，因此崩溃期间不会更新已修改的分支和标记。 分支和标记信息可在崩溃报告中找到，如果需要更新，必须手动应用。</p>
</div>
<div class="paragraph">
<p>崩溃实例：</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="literalblock">
<div class="content">
<pre>$ cat &gt;in &lt;&lt;END_OF_INPUT
# 我的第一次测试提交
commit refs/heads/master
committer Shawn O. Pearce &lt;spearce&gt; 19283 -0400
# 那家伙到底是谁？
data &lt;&lt;EOF
这是我的提交
EOF
M 644 inline .gitignore
data &lt;&lt;EOF
.gitignore
EOF
M 777 inline bob
END_OF_INPUT</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>$ git fast-import &lt;in
fatal: Corrupt mode: M 777 inline bob
fast-import: dumping crash report to .git/fast_import_crash_8434</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>$ cat .git/fast_import_crash_8434
fast-import crash report:
    fast-import process: 8434
    parent process     : 1391
    at Sat Sep 1 00:58:12 2007</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>fatal: Corrupt mode: M 777 inline bob（失败：错误的模式：M 777 ）</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>Most Recent Commands Before Crash
---------------------------------
  # my very first test commit（我最开始的测试提交）
  commit refs/heads/master
  committer Shawn O. Pearce &lt;spearce&gt; 19283 -0400
  # who is that guy anyway?（这是什么？）
  data &lt;&lt;EOF
  M 644 inline .gitignore
  data &lt;&lt;EOF
* M 777 inline bob</pre>
</div>
</div>
<div class="paragraph">
<p>Active Branch LRU</p>
</div>
<div class="listingblock">
<div class="content">
<pre>active_branches = 1 cur, 5 max

          pos clock name ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
           1)      0 refs/heads/master

Inactive Branches</pre>
</div>
</div>
<div class="paragraph">
<p>refs/heads/master:
status      : active loaded dirty
tip commit  : 0000000000000000000000000000000000000000
old tree    : 0000000000000000000000000000000000000000
cur tree    : 0000000000000000000000000000000000000000
commit clock: 0
last pack   :</p>
</div>
<div class="literalblock">
<div class="content">
<pre>------------------- END OF CRASH REPORT</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_提示和技巧">提示和技巧</h2>
<div class="sectionbody">
<div class="paragraph">
<p>以下提示和技巧是从 fast-import 的不同用户那里收集的，在此作为建议提供。</p>
</div>
<div class="sect2">
<h3 id="_每次承诺使用一个标记">每次承诺使用一个标记</h3>
<div class="paragraph">
<p>在进行仓转换时，每个提交使用一个唯一的标记（标记 <code>:</code><em>&lt;n&gt;</em>），并在命令行中提供 --export-marks 选项。 如果前端能将标记与源代码仓库绑定，就能通过比较每个 Git 提交和相应的源代码版本，轻松验证导入的准确性和完整性。</p>
</div>
<div class="paragraph">
<p>从 Perforce 或 Subversion 等系统导入时，这应该非常简单，因为快速导入标记也可以是 Perforce 更改集编号或 Subversion 修订编号。</p>
</div>
</div>
<div class="sect2">
<h3 id="_自由跳转分支">自由跳转分支</h3>
<div class="paragraph">
<p>在导入过程中，不要费心去优化前端，使其一次只针对一个分支。 虽然这样做可能会稍微加快快速导入的速度，但往往会大大增加前端代码的复杂性。</p>
</div>
<div class="paragraph">
<p>fast-import 内置的分支 LRU 通常表现非常出色，而且激活非活动分支的成本很低，在分支间跳来跳去对导入性能几乎没有影响。</p>
</div>
</div>
<div class="sect2">
<h3 id="_处理重命名">处理重命名</h3>
<div class="paragraph">
<p>在导入重命名的文件或目录时，只需在相应的提交过程中删除旧名称并修改新名称即可。 Git 会在事后执行重命名检测，而不是在提交时明确执行。</p>
</div>
</div>
<div class="sect2">
<h3 id="_使用标签修复分支">使用标签修复分支</h3>
<div class="paragraph">
<p>其他一些 SCM 系统允许用户从多个文件创建标签，而这些文件并非来自同一提交/变更集。 或者创建的标签是仓库中可用文件的子集。</p>
</div>
<div class="paragraph">
<p>如果不至少提交一次 <em>'修</em>' 文件以匹配标签内容，就无法在 Git 中原样导入这些标签。 使用 fast-import 的 <code>reset</code> 命令，在正常分支空间外重置一个假分支，使其与标签的基本提交一致，然后提交一次或多次文件修复提交，最后给假分支打上标签。</p>
</div>
<div class="paragraph">
<p>例如，由于所有正常分支都存储在 <code>refs/heads/</code> 下，因此将标记修复分支命名为 <code>TAG_FIXUP</code>。 这样，导入程序使用的修复分支就不可能与从源代码导入的真正分支发生命名空间冲突（名称 <code>TAG_FIXUP</code> 不是 <code>refs/heads/TAG_FIXUP</code>）。</p>
</div>
<div class="paragraph">
<p>提交修复时，请考虑使用 <code>merge</code> 将提供文件修订的提交连接到修复分支。 这样做可以让 <em>git blame</em> 等工具追踪真实的提交历史，并正确地注释源文件。</p>
</div>
<div class="paragraph">
<p>快速导入结束后，前台需要执行 <code>rm</code> <code>.git/TAG_FIXUP</code> 来移除虚拟分支。</p>
</div>
</div>
<div class="sect2">
<h3 id="_立即导入稍后重新打包">立即导入，稍后重新打包</h3>
<div class="paragraph">
<p>快速导入完成后，Git 仓库就完全有效，可以随时使用。 通常这只需要很短的时间，即使对于相当大的项目（100,000+ 次提交）也是如此。</p>
</div>
<div class="paragraph">
<p>不过，为了提高数据的位置性和访问性能，有必要重新打包仓库。 在超大型项目中，这也可能需要数小时（尤其是在使用 -f 和较大的 --window 参数时）。 由于重新打包可以安全地与读写器同时运行，因此请在后台运行重新打包，并让它在完成时完成。 没有理由等待探索新的 Git 项目！</p>
</div>
<div class="paragraph">
<p>如果您选择等待重新打包，在重新打包完成之前不要尝试运行基准或性能测试。</p>
</div>
</div>
<div class="sect2">
<h3 id="_重新打包历史数据">重新打包历史数据</h3>
<div class="paragraph">
<p>如果您要重新打包非常旧的导入数据（例如，比去年更旧的数据），可以考虑在运行 <em>git repack</em> 时花费一些额外的 CPU 时间并提供 --window=50（或更高）的参数。 这样会花费更多时间，但生成的打包文件也会更小。 您只需花费一次精力，而使用您项目的每个人都将受益于更小的仓库。</p>
</div>
</div>
<div class="sect2">
<h3 id="_包括一些进展信息">包括一些进展信息</h3>
<div class="paragraph">
<p>每隔一段时间，让你的前端向快速导入发出一条 <code>progress</code>（进度）信息。 消息的内容可以完全自由发挥，因此建议在当前提交日期进入下一个月时，输出当前月份和年份。 这样，用户就能更好地了解数据流的处理情况。</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_包文件优化">包文件优化</h2>
<div class="sectionbody">
<div class="paragraph">
<p>在打包 blob 时，fast-import 总是尝试根据最后写入的 blob 进行 deltify。 除非前端特别安排，否则这很可能不是同一文件的先前版本，因此生成的 delta 不会是尽可能小的。 生成的打包文件将被压缩，但不会达到最佳效果。</p>
</div>
<div class="paragraph">
<p>可以高效访问单个文件所有修订版本的前端（例如读取 RCS/CVS ,v 文件），可以选择以连续的 <code>blob</code> 命令序列提供该文件的所有修订版本。 这样，快速导入程序就能将不同的文件修订版本相互区分开来，从而节省最终打包文件的空间。 标记可用于以后在一连串 <code>commit</code> 命令中识别单个文件修订版。</p>
</div>
<div class="paragraph">
<p>fast-import 创建的包文件不支持良好的磁盘访问模式。 这是因为 fast-import 是按照标准输入的顺序写入数据的，而 Git 通常会在包文件中组织数据，使最新的（当前提示）数据出现在历史数据之前。 Git 还会将提交聚类在一起，通过更好的缓存定位加快版本遍历速度。</p>
</div>
<div class="paragraph">
<p>因此，强烈建议用户在 fast-import 完成后使用 <code>git</code> <code>repack</code> <code>-a</code> <code>-d</code> 重新打包仓库，让 Git 重新组织打包文件以加快数据访问速度。 如果 blob deltas 是次优的（见上文），那么添加 <code>-f</code> 选项来强制重新计算所有 deltas，也能显著减少最终打包文件的大小（通常能减少 30-50%）。</p>
</div>
<div class="paragraph">
<p>你也可以不运行 <code>git</code> <code>repack</code> 而运行 <code>git</code> <code>gc--aggressive</code>，它也会在导入后优化其他事情（比如打包松散的引用）。正如 <a href="git-gc.html">git-gc(1)</a> 中的 "AGRESSIVE "部分所述，<code>--aggressive</code> 选项会在 <a href="git-repack.html">git-repack(1)</a> 中使用 <code>-f</code> 选项找到新的 deltas。由于上述原因，在快速导入后使用 <code>--aggressive</code> 是为数不多的值得这么做的情况。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_内存利用率">内存利用率</h2>
<div class="sectionbody">
<div class="paragraph">
<p>影响 fast-import 导入所需内存的因素有很多。 与核心 Git 的关键部分一样，fast-import 使用自己的内存分配器来摊销与 malloc 相关的开销。 在实践中，由于 fast-import 使用了大量的块分配，它往往会将 malloc 的开销摊销为 0。</p>
</div>
<div class="sect2">
<h3 id="_每个对象">每个对象</h3>
<div class="paragraph">
<p>fast-import 会为本次执行中写入的每个对象维护一个内存结构。 在 32 位系统中，该结构为 32 字节，在 64 位系统中，该结构为 40 字节（由于指针尺寸较大）。 表中的对象在 fast-import 终止前不会被重新分配。 在 32 位系统上导入 200 万个对象大约需要 64 MiB 内存。</p>
</div>
<div class="paragraph">
<p>对象表实际上是一个以对象名称（唯一的 SHA-1）为键的哈希表。 这种存储配置允许 fast-import 重用现有或已写入的对象，避免将重复的对象写入输出包文件。 在导入过程中，重复的 blob 会非常常见，这通常是由于源代码中的分支合并造成的。</p>
</div>
</div>
<div class="sect2">
<h3 id="_每个标记">每个标记</h3>
<div class="paragraph">
<p>标记存储在一个稀疏数组中，每个标记使用 1 个指针（4 字节或 8 字节，取决于指针大小）。 虽然数组是稀疏的，但仍强烈建议前端使用 1 到 n 之间的标记，其中 n 是本次导入所需的标记总数。</p>
</div>
</div>
<div class="sect2">
<h3 id="_每个分支">每个分支</h3>
<div class="paragraph">
<p>分支分为活动分支和非活动分支。 这两类分支的内存使用量差别很大。</p>
</div>
<div class="paragraph">
<p>非活动分支存储在一个结构中，每个分支使用 96 或 120 字节（分别用于 32 位或 64 位系统），外加分支名称的长度（通常小于 200 字节）。</p>
</div>
<div class="paragraph">
<p>活动分支的开销与非活动分支相同，但也包含该分支上最近修改过的每棵树的副本。 如果子树 <code>include</code> 在分支变为活动后没有被修改过，其内容就不会被加载到内存中，但如果子树 <code>src</code> 在分支变为活动后被提交修改过，其内容就会被加载到内存中。</p>
</div>
<div class="paragraph">
<p>由于活动分支存储的是该分支所含文件的元数据，因此其内存存储容量可能会相当大（见下文）。</p>
</div>
<div class="paragraph">
<p>fast-import 根据一种简单的最近最少使用算法，自动将活动分支移至非活动状态。 LRU 链会在每一条 <code>commit</code> 命令中更新。 可以在命令行中使用 --active-branches= 来增加或减少活动分支的最大数量。</p>
</div>
</div>
<div class="sect2">
<h3 id="_每个活动目录树">每个活动目录树</h3>
<div class="paragraph">
<p>树（又称目录）在其条目（见下文 <em>'每个活动文件</em>'）所需内存之外，仅占用 12 字节内存。 树的成本几乎为零，因为其开销会在单个文件条目中摊销。</p>
</div>
</div>
<div class="sect2">
<h3 id="_每个活动文件条目">每个活动文件条目</h3>
<div class="paragraph">
<p>活动目录树中的文件（和指向子目录树的指针）每个条目需要 52 或 64 字节（32/64 位平台）。 为了节省空间，文件名和目录树名被集中到一个通用的字符串表中，这样无论文件名 <em>'Makefile</em>' 在项目中出现多少次，都只需使用 16 个字节（包括字符串头开销）。</p>
</div>
<div class="paragraph">
<p>活动分支 LRU 与文件名字符串池和子树的懒加载相结合，使 fast-import 能够在非常有限的内存空间内（每个活动分支小于 2.7 MiB）高效导入包含 2,000 多个分支和 45,114 多个文件的项目。</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_信号">信号</h2>
<div class="sectionbody">
<div class="paragraph">
<p>向 <em>git fast-import</em> 进程发送 <strong>SIGUSR1</strong> 会提前结束当前的打包文件，模拟一个 <code>checkpoint</code> 命令。 没有耐心的操作员可以使用这一工具来偷看正在导入的对象和引用，但代价是增加运行时间和降低压缩率。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_配置">配置</h2>
<div class="sectionbody">
<div class="paragraph">
<p>本节中这一行以下的内容都是从 <a href="git-config.html">git-config(1)</a> 文档中摘录的。其内容与那里的内容相同：</p>
</div>
<div class="paragraph">
<p>Unresolved directive in git-fast-import.adoc - include::config/fastimport.adoc[]</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_参见">参见</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="git-fast-export.html">git-fast-export(1)</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_git">GIT</h2>
<div class="sectionbody">
<div class="paragraph">
<p>属于 <a href="git.html">git(1)</a> 文档</p>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2025-03-23 12:03:52 +0100
</div>
</div>
</body>
</html>